<div class="content-wrapper">
  <app-user-search (eventSearch)="search($event)"></app-user-search>
  <div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">
          <table class="table table-hover">
            <thead>
            <tr>
              <th style="width: 10px;">{{'table.number'|transloco}}</th>
              <th>{{'table.emp.code'|transloco}}</th>
              <th>{{'table.name'|transloco}}</th>
              <th>{{'table.username'|transloco}}</th>
              <th>{{'table.email'|transloco}}</th>
              <th>{{'table.phone'|transloco}}</th>
              <th>{{'table.emp.unit'|transloco}}</th>
              <th style="width: 15px;">{{'table.action'|transloco}}</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let user of users, index as i">
              <td>{{i+1}}</td>
              <td>{{user.code}}</td>
              <td>{{user.firstName}} {{user.lastName}}</td>
              <td>{{user.username}}</td>
              <td>{{user.email}}</td>
              <td>{{user.numberPhone}}</td>
              <td>{{user.unitName}}</td>
              <td ngbDropdown container="body">
                <div class="dropdown">
                  <button class="btn btn-sm btn-primary dropdown-toggle" type="button" [id]="'ddBtn'+user.id"
                          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{'button.action'|transloco}}</button>
                  <div class="dropdown-menu" aria-labelledby="{{'ddBtn'+user.id}}">
                    <a class="dropdown-item btn btn-sm">{{'button.detail'|transloco}}</a>
                    <a class="dropdown-item btn btn-sm" (click)="openModal(lockModal, user)" *ngIf="user.accountNonLocked">{{'button.lock'|transloco}}</a>
                    <a class="dropdown-item btn btn-sm" (click)="openModal(openLockModal, user)" *ngIf="!user.accountNonLocked">{{'button.open'|transloco}}</a>
                    <a class="dropdown-item btn btn-sm" (click)="openModal(deleteModal, user)">{{'button.delete'|transloco}}</a>
                  </div>
                </div>
              </td>
            </tr>
            </tbody>
          </table>
          <div *ngIf="users==null||users.length==0">
            <h6 style="color: red;">{{'error.empty_list_data'|transloco}}</h6>
          </div>
          <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [maxSize]="maxSize"
                          [rotate]="true" [ellipses]="false" [boundaryLinks]="true"
                          [pageSize]="pageSize" (pageChange)="pageChange()"></ngb-pagination>
        </div>
      </div>
    </div>
  </div>
</div>


<ng-template #deleteModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">{{'label.notification'|transloco}}</h4>
  </div>
  <div class="modal-body">
    {{'message.delete'|transloco}}
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-sm btn-secondary" (click)="modal.dismiss()">{{'button.cancel'|transloco}}</button>
    <button type="button" class="btn btn-sm btn-danger" (click)="deleteById()">{{'button.delete'|transloco}}</button>
  </div>
</ng-template>
<ng-template #lockModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">{{'label.notification'|transloco}}</h4>
  </div>
  <div class="modal-body">
    {{'message.lock_user'|transloco}}
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-sm btn-secondary" (click)="modal.dismiss()">{{'button.cancel'|transloco}}</button>
    <button type="button" class="btn btn-sm btn-danger" (click)="lock()">{{'button.lock'|transloco}}</button>
  </div>
</ng-template>
<ng-template #openLockModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">{{'label.notification'|transloco}}</h4>
  </div>
  <div class="modal-body">
    {{'message.open_user'|transloco}}
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-sm btn-secondary" (click)="modal.dismiss()">{{'button.cancel'|transloco}}</button>
    <button type="button" class="btn btn-sm btn-danger" (click)="openLock()">{{'button.open'|transloco}}</button>
  </div>
</ng-template>
